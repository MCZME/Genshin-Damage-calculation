# 阶段三设计：战果复盘 (Review Phase)

## 1. 阶段概述
阶段三是仿真流程的分析阶段。基于 SQLite 存储的全帧快照数据，UI 提供毫秒级的随机访问与回溯能力。本阶段所有配置项处于锁定状态（只读），界面重心完全转向数据可视化与物理轨迹复现。

## 2. 布局设计 (Workbench Layout)

### 2.1 左栏：数据摘要 (Result Summary)
*   **核心指标**: 展示总伤害 (Total DMG)、平均 DPS、峰值 DPS 等全局统计。
*   **分布分析**: 
    *   角色伤害占比饼图。
    *   元素反应触发频次统计表。
*   **控制**: `[回溯编辑]` 按钮，点击后 UI 解锁并回退至阶段一/二。

### 2.2 中栏：分析仪表盘 (The Dashboard) —— **核心区域**
*   **时间轴控制器**: 位于顶部的全局滑块，控制全界面的帧步进。
*   **可视化图表 (Plotly)**: 
    *   实时展示 DPS 曲线。
    *   点击图表中的波峰或波谷，时间轴滑块自动同步跳转。
*   **事件流 (Event Stream)**: 
    *   流式列出每一帧触发的关键事件（如：`香菱 旋火轮 蒸发 35000`）。
    *   支持点击事件以展开“伤害计算详情面板”，展示所有乘区快照。

### 2.3 右栏：物理空间回溯 (Physical Replay)
*   **战场快照**: 
    *   俯视角 2D 坐标网格。
    *   随时间轴滑块实时更新实体的 `(X, Z)` 位置。
*   **状态可视化**: 
    *   实体图标上方动态显示元素附着（Aura）状态。
    *   显示当前帧实体的受击碰撞体状态。
*   **逻辑**: 纯净展示仿真结果，不接受位置修改指令。

## 3. 核心交互：全同步回溯 (The Sync Sync)
*   **触发源**: 时间轴滑块的变动。
*   **同步项**:
    1. 图表游标移动。
    2. 右栏实体物理位移。
    3. 右栏实体附着状态更新。
    4. 底部事件流列表定位。
    5. 当前帧所有实体的属性快照（ViewModel 更新）。

## 4. 设计逻辑：只读一致性 (Read-Only Consistency)
*   为确保结论的严肃性，阶段三严格禁止修改任何实验变量（词条、动作、位置）。
*   若需修改，必须通过 `[回溯编辑]` 主动切换 UI 状态。

---
*版本: v1.0.0*
*日期: 2026-02-08*
